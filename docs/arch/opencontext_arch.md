ğŸ“ OpenContext æ¶æ„è®¾è®¡æ–‡æ¡£
1. ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Electron Frontend                               â”‚
â”‚                     (React + TypeScript + TailwindCSS)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  IPC Bridge                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          FastAPI Backend (Python)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Server    â”‚  â”‚  Managers   â”‚  â”‚  Context    â”‚  â”‚   Context           â”‚ â”‚
â”‚  â”‚   (API)     â”‚  â”‚             â”‚  â”‚  Capture    â”‚  â”‚   Consumption       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Storage    â”‚  â”‚    LLM      â”‚  â”‚   Tools     â”‚  â”‚   Context           â”‚ â”‚
â”‚  â”‚  Layer      â”‚  â”‚  Clients    â”‚  â”‚   System    â”‚  â”‚   Processing        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     ChromaDB        â”‚  â”‚      SQLite         â”‚  â”‚   File System       â”‚  â”‚
â”‚  â”‚  (Vector Storage)   â”‚  â”‚  (Document Store)   â”‚  â”‚   (Screenshots)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2. æ ¸å¿ƒæ¨¡å—æ¶æ„
2.1 åˆ†å±‚æ¶æ„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Presentation Layer                         â”‚
â”‚                 (FastAPI Routes + REST API)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Application Layer                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚   Managers   â”‚  â”‚    Agent     â”‚  â”‚     Generators       â”‚ â”‚
â”‚   â”‚              â”‚  â”‚   Workflow   â”‚  â”‚                      â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       Domain Layer                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚  Processors  â”‚  â”‚    Tools     â”‚  â”‚       Models         â”‚ â”‚
â”‚   â”‚              â”‚  â”‚              â”‚  â”‚                      â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Infrastructure Layer                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚   Storage    â”‚  â”‚ LLM Clients  â”‚  â”‚      Config          â”‚ â”‚
â”‚   â”‚   Backends   â”‚  â”‚              â”‚  â”‚                      â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2.2 æ¨¡å—ä¾èµ–å…³ç³»
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Server    â”‚
                    â”‚   (API)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 â”‚                 â”‚
         â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Capture    â”‚   â”‚  Processor  â”‚   â”‚  Consumption    â”‚
â”‚  Manager    â”‚   â”‚  Manager    â”‚   â”‚  Manager        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                 â”‚                    â”‚
       â–¼                 â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Capture    â”‚   â”‚ Processors  â”‚   â”‚   Generators    â”‚
â”‚ Components  â”‚   â”‚             â”‚   â”‚   + Agent       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                 â”‚                    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Global Singletons â”‚
              â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
              â”‚ â”‚Storeâ”‚ â”‚LLM/VLM  â”‚ â”‚
              â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. æ•°æ®æµæ¶æ„
3.1 ä¸Šä¸‹æ–‡æ•è·-å¤„ç†-å­˜å‚¨æµç¨‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Data Pipeline                                   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Capture   â”‚â”€â”€â”€â–¶â”‚  Manager   â”‚â”€â”€â”€â–¶â”‚ Processor  â”‚â”€â”€â”€â–¶â”‚   Storage    â”‚ â”‚
â”‚  â”‚ Component  â”‚    â”‚  Callback  â”‚    â”‚  Process   â”‚    â”‚   Upsert     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                                    â”‚                   â”‚         â”‚
â”‚       â–¼                                    â–¼                   â–¼         â”‚
â”‚  RawContext                         ProcessedContext      ChromaDB +    â”‚
â”‚  Properties                         (with vectors)         SQLite       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


3.2 Agent å·¥ä½œæµ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Agent Workflow Pipeline                           â”‚
â”‚                                                                         â”‚
â”‚   User Query                                                            â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚  Intent Node    â”‚â”€â”€â–¶ Simple Chat? â”€â”€Yesâ”€â”€â–¶ Direct Response           â”‚
â”‚  â”‚  (åˆ†ææ„å›¾)      â”‚                                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚           â”‚ No (Complex Query)                                          â”‚
â”‚           â–¼                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚  Context Node   â”‚â”€â”€â”€â”€â–¶â”‚  Tool Executor  â”‚                           â”‚
â”‚  â”‚  (æ”¶é›†ä¸Šä¸‹æ–‡)    â”‚â—€â”€â”€â”€â”€â”‚  (å¹¶è¡Œæ‰§è¡Œå·¥å…·)  â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚           â”‚ Loop (max 2 iterations)                                     â”‚
â”‚           â–¼                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚ Sufficiency     â”‚â”€â”€â–¶ INSUFFICIENT? â”€â”€â–¶ Continue Loop                â”‚
â”‚  â”‚ Evaluation      â”‚                                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚           â”‚ SUFFICIENT/PARTIAL                                          â”‚
â”‚           â–¼                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚  Executor Node  â”‚â”€â”€â”€â”€â–¶â”‚  Streaming      â”‚â”€â”€â–¶ Final Response          â”‚
â”‚  â”‚  (ç”Ÿæˆå“åº”)      â”‚     â”‚  Manager        â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
4. æ ¸å¿ƒè®¾è®¡æ¨¡å¼
4.1 å•ä¾‹æ¨¡å¼ (Singleton)
åº”ç”¨åœºæ™¯: å…¨å±€é…ç½®ã€å­˜å‚¨ã€LLM å®¢æˆ·ç«¯

```python
# å…¸å‹å®ç°
class GlobalConfig:
    _instance = None
    
    @classmethod
    def get_instance(cls) -> "GlobalConfig":
        if cls._instance is None:
            cls._instance = cls()
        return cls._instance

# ä½¿ç”¨çš„å•ä¾‹
GlobalConfig      # å…¨å±€é…ç½®
GlobalStorage     # å…¨å±€å­˜å‚¨
GlobalVLMClient   # VLM å®¢æˆ·ç«¯
GlobalEmbeddingClient  # Embedding å®¢æˆ·ç«¯
```
4.2 ç­–ç•¥æ¨¡å¼ (Strategy)
åº”ç”¨åœºæ™¯: æ—¥æŠ¥ç”Ÿæˆã€å­˜å‚¨åç«¯

```python
# æ—¥æŠ¥ç”Ÿæˆç­–ç•¥
class ReportGenerator:
    def _get_strategy(self):
        if self._use_long_context:
            return LongContextReportGenerator()
        else:
            return HourlyChunkingReportGenerator()

# å­˜å‚¨åç«¯ç­–ç•¥
class StorageBackendFactory:
    @staticmethod
    def create_backend(storage_type: str) -> IStorageBackend:
        if storage_type == "chromadb":
            return ChromaDBBackend()
        elif storage_type == "qdrant":
            return QdrantBackend()
        elif storage_type == "sqlite":
            return SQLiteBackend()
```
4.3 æ¨¡æ¿æ–¹æ³•æ¨¡å¼ (Template Method)
åº”ç”¨åœºæ™¯: å¤„ç†å™¨ã€èŠ‚ç‚¹åŸºç±»

```python
class BaseContextProcessor(IContextProcessor):
    def process(self, context: RawContextProperties) -> Optional[ProcessedContext]:
        if not self.can_process(context):
            return None
        return self._do_process(context)  # å­ç±»å®ç°
    
    @abstractmethod
    def can_process(self, context) -> bool: ...
    
    @abstractmethod
    def _do_process(self, context) -> ProcessedContext: ...
```
4.4 è§‚å¯Ÿè€…æ¨¡å¼ (Observer)
åº”ç”¨åœºæ™¯: äº‹ä»¶ç®¡ç†å™¨

```python
class EventManager:
    def publish_event(self, event_type: EventType, data: dict):
        event = Event(id=uuid4(), type=event_type, data=data)
        self.event_cache.append(event)
    
    def fetch_and_clear_events(self) -> List[dict]:
        events = [e.to_dict() for e in self.event_cache]
        self.event_cache.clear()
        return events
```
4.5 å·¥å‚æ¨¡å¼ (Factory)
åº”ç”¨åœºæ™¯: å­˜å‚¨åç«¯åˆ›å»º

```python
class StorageBackendFactory:
    _backend_registry = {
        "chromadb": ChromaDBBackend,
        "qdrant": QdrantBackend,
        "lancedb": LanceDBBackend,
        "sqlite": SQLiteBackend,
    }
    
    @classmethod
    def create(cls, backend_type: str) -> IStorageBackend:
        return cls._backend_registry[backend_type]()
```
5. æ¥å£è®¾è®¡
5.1 æ ¸å¿ƒæ¥å£å®šä¹‰

```python
# æ•è·ç»„ä»¶æ¥å£
class ICaptureComponent(ABC):
    @abstractmethod
    def initialize(self, config: dict) -> bool: ...
    @abstractmethod
    def start(self) -> None: ...
    @abstractmethod
    def stop(self) -> None: ...
    @abstractmethod
    def capture(self) -> List[RawContextProperties]: ...
    @abstractmethod
    def is_running(self) -> bool: ...

# å¤„ç†å™¨æ¥å£
class IContextProcessor(ABC):
    @abstractmethod
    def can_process(self, context: RawContextProperties) -> bool: ...
    @abstractmethod
    def process(self, context: RawContextProperties) -> Optional[ProcessedContext]: ...

# å‘é‡å­˜å‚¨æ¥å£
class IVectorStorageBackend(ABC):
    @abstractmethod
    def initialize(self, config: dict) -> bool: ...
    @abstractmethod
    def search(self, query: str, limit: int, filters: dict) -> List[ProcessedContext]: ...
    @abstractmethod
    def upsert_processed_context(self, context: ProcessedContext) -> bool: ...

# å·¥å…·æ¥å£
class BaseTool(ABC):
    @abstractmethod
    def get_name(self) -> str: ...
    @abstractmethod
    def get_description(self) -> str: ...
    @abstractmethod
    def get_parameters(self) -> dict: ...
    @abstractmethod
    def execute(self, **kwargs) -> ToolResult: ...
```
5.2 REST API æ¥å£
ç«¯ç‚¹	æ–¹æ³•	åŠŸèƒ½
/api/health	GET	å¥åº·æ£€æŸ¥
/api/chat	POST	Agent å¯¹è¯
/api/chat/stream	POST	æµå¼å¯¹è¯
/api/contexts	GET	è·å–ä¸Šä¸‹æ–‡åˆ—è¡¨
/api/vaults	GET/POST	æ–‡æ¡£ç®¡ç†
/api/events	GET	è·å–äº‹ä»¶
/api/settings	GET/PUT	é…ç½®ç®¡ç†
6. å­˜å‚¨æ¶æ„
6.1 åŒå­˜å‚¨æ¶æ„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     UnifiedStorage                          â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚   Vector Backend    â”‚   â”‚      Document Backend       â”‚â”‚
â”‚   â”‚                     â”‚   â”‚                             â”‚â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚   â”‚  â”‚   ChromaDB    â”‚  â”‚   â”‚  â”‚       SQLite          â”‚ â”‚â”‚
â”‚   â”‚  â”‚               â”‚  â”‚   â”‚  â”‚                       â”‚ â”‚â”‚
â”‚   â”‚  â”‚ Collections:  â”‚  â”‚   â”‚  â”‚ Tables:               â”‚ â”‚â”‚
â”‚   â”‚  â”‚ - activity    â”‚  â”‚   â”‚  â”‚ - vaults              â”‚ â”‚â”‚
â”‚   â”‚  â”‚ - intent      â”‚  â”‚   â”‚  â”‚ - todo                â”‚ â”‚â”‚
â”‚   â”‚  â”‚ - semantic    â”‚  â”‚   â”‚  â”‚ - activity            â”‚ â”‚â”‚
â”‚   â”‚  â”‚ - procedural  â”‚  â”‚   â”‚  â”‚ - tips                â”‚ â”‚â”‚
â”‚   â”‚  â”‚ - state       â”‚  â”‚   â”‚  â”‚ - conversations       â”‚ â”‚â”‚
â”‚   â”‚  â”‚ - entity      â”‚  â”‚   â”‚  â”‚ - messages            â”‚ â”‚â”‚
â”‚   â”‚  â”‚ - todo        â”‚  â”‚   â”‚  â”‚ - monitoring_*        â”‚ â”‚â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

6.2 ChromaDB Collection ç»“æ„
æ¯ä¸ª context_type å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„ Collection:
```python
# Collection å…ƒæ•°æ®
{
    "hnsw:space": "cosine",  # ä½™å¼¦ç›¸ä¼¼åº¦
    "context_type": "activity_context"
}

# Document ç»“æ„
{
    "id": "uuid",
    "document": "vectorize.text",  # ç”¨äºå‘é‡åŒ–çš„æ–‡æœ¬
    "embedding": [0.1, 0.2, ...],  # 2048 ç»´å‘é‡
    "metadata": {
        "title": "...",
        "summary": "...",
        "context_type": "...",
        "source": "...",
        "create_time_ts": 1703318400,
        "update_time_ts": 1703318400,
        "entities": ["entity1", "entity2"],
        "keywords": ["keyword1", "keyword2"]
    }
}
```
7. å¹¶å‘ä¸å¼‚æ­¥æ¶æ„
7.1 çº¿ç¨‹æ¨¡å‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Main Thread                              â”‚
â”‚                    (FastAPI + uvicorn)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Capture    â”‚  â”‚  Processor   â”‚  â”‚   Consumption        â”‚ â”‚
â”‚  â”‚   Threads    â”‚  â”‚  ThreadPool  â”‚  â”‚   Timer Threads      â”‚ â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                      â”‚ â”‚
â”‚  â”‚ - Screenshot â”‚  â”‚ ThreadPool   â”‚  â”‚ - Activity (15min)   â”‚ â”‚
â”‚  â”‚ - FolderMon  â”‚  â”‚ Executor     â”‚  â”‚ - Tips (60min)       â”‚ â”‚
â”‚  â”‚ - VaultMon   â”‚  â”‚ (workers=4)  â”‚  â”‚ - Todo (30min)       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       Async Event Loop                          â”‚
â”‚                  (Agent Workflow + LLM Calls)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

7.2 å¼‚æ­¥å¤„ç†æ¨¡å¼
```python
# Agent å·¥ä½œæµ - å¼‚æ­¥å¤„ç†
async def process_stream(self, query: str) -> AsyncIterator[StreamEvent]:
    async for event in self.workflow_engine.execute_stream(state):
        yield event

# LLM è°ƒç”¨ - åŒæ­¥åŒ…è£…å¼‚æ­¥
def generate_with_messages(messages: list) -> str:
    return asyncio.run(_generate_async(messages))

# å·¥å…·å¹¶è¡Œæ‰§è¡Œ
async def execute_tool_calls_parallel(tool_calls: list):
    with ThreadPoolExecutor() as executor:
        futures = [executor.submit(tool.execute, **args) for tool, args in tool_calls]
        return [f.result() for f in futures]
```
8. é…ç½®æ¶æ„
8.1 é…ç½®å±‚æ¬¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Environment Variables                   â”‚
â”‚         (LLM_BASE_URL, LLM_API_KEY, etc.)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 config.yaml                          â”‚
â”‚            (ç³»ç»Ÿé»˜è®¤é…ç½®)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              user_setting.yaml                       â”‚
â”‚            (ç”¨æˆ·è‡ªå®šä¹‰è¦†ç›–)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Runtime Configuration                       â”‚
â”‚            (åŠ¨æ€ä¿®æ”¹)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         ä¼˜å…ˆçº§: ä¸Šå±‚è¦†ç›–ä¸‹å±‚

8.2 é…ç½®ç®¡ç†å™¨
```python
class ConfigManager:
    def __init__(self, config_path: str):
        self.config = self._load_yaml(config_path)
        self.user_setting = self._load_user_setting()
        self._merge_configs()
        self._expand_env_variables()

class GlobalConfig:
    # æä¾›ä¾¿æ·è®¿é—®æ–¹æ³•
    @classmethod
    def get_config(cls, key: str) -> Any: ...
    
    @classmethod
    def get_prompt_group(cls, key: str) -> dict: ...
```
9. æ‰©å±•æ€§è®¾è®¡
9.1 æ·»åŠ æ–°çš„æ•è·ç»„ä»¶
```python
# 1. å®ç°æ¥å£
class NewCaptureComponent(ICaptureComponent):
    def initialize(self, config): ...
    def start(self): ...
    def stop(self): ...
    def capture(self) -> List[RawContextProperties]: ...

# 2. æ³¨å†Œåˆ°ç®¡ç†å™¨
capture_manager.register_component("new_capture", NewCaptureComponent())

```
9.2 æ·»åŠ æ–°çš„å¤„ç†å™¨

```python
# 1. ç»§æ‰¿åŸºç±»
class NewProcessor(BaseContextProcessor):
    def can_process(self, context): ...
    def _do_process(self, context): ...

# 2. æ›´æ–°è·¯ç”±è¡¨
PROCESSOR_ROUTING = {
    ContextSource.NEW_SOURCE: "new_processor"
}
```
9.3 æ·»åŠ æ–°çš„å·¥å…·
```python
# 1. ç»§æ‰¿åŸºç±»
class NewTool(BaseTool):
    def get_name(self) -> str: return "new_tool"
    def get_description(self) -> str: return "..."
    def get_parameters(self) -> dict: return {...}
    def execute(self, **kwargs) -> ToolResult: ...

# 2. æ³¨å†Œåˆ°å·¥å…·å®šä¹‰
ALL_TOOL_DEFINITIONS.append(
    {"type": "function", "function": NewTool.get_definition()}
)
```
10. TypeScript/LangGraph è¿ç§»æŒ‡å—
10.1 LangGraph æ¶æ„æ˜ å°„
Python ç»„ä»¶	LangGraph å¯¹åº”
WorkflowEngine	StateGraph
BaseNode	Graph Node Function
WorkflowState	State Schema (TypedDict)
StreamingManager	StreamEvents
ToolsExecutor	ToolNode

10.2 å…³é”®ç±»å‹å®šä¹‰
```typescript
// æ ¸å¿ƒçŠ¶æ€ç±»å‹
interface WorkflowState {
  query: QueryInfo;
  stage: WorkflowStage;
  intent: IntentInfo;
  contexts: ContextCollection;
  executionPlan: ExecutionPlan;
  executionResult: ExecutionResult;
}

// èŠ‚ç‚¹å®šä¹‰
const intentNode = async (state: WorkflowState): Promise<Partial<WorkflowState>> => {
  // æ„å›¾åˆ†æé€»è¾‘
};

// å›¾æ„å»º
const graph = new StateGraph<WorkflowState>()
  .addNode("intent", intentNode)
  .addNode("context", contextNode)
  .addNode("executor", executorNode)
  .addEdge("intent", "context")
  .addConditionalEdges("context", shouldContinue)
  .addEdge("executor", END);
```
10.3 å·¥å…·ç³»ç»Ÿæ˜ å°„
```typescript
// LangChain Tool å®šä¹‰
const activityContextTool = new DynamicStructuredTool({
  name: "get_activity_context",
  description: "Retrieve activity context within a time range",
  schema: z.object({
    query: z.string().optional(),
    startTime: z.number().optional(),
    endTime: z.number().optional(),
    entities: z.array(z.string()).optional(),
    limit: z.number().default(10),
  }),
  func: async (params) => {
    // è°ƒç”¨å‘é‡æ•°æ®åº“
  },
});

```
è¿™ä¸¤ä»½æ–‡æ¡£æ¶µç›–äº† OpenContext çš„å®Œæ•´åŠŸèƒ½æè¿°å’Œæ¶æ„è®¾è®¡ã€‚